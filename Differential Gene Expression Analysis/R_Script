#loading of packages 
install.packages(c("BiocManager","pheatmap","ggpubr","ggrepel","RSQLite","tidyverse"))

library(pheatmap)
library(ggpubr)
library(ggrepel)
library(RSQLite)
library(tidyverse)
library(BiocManager)
BiocManager::install(c("affy","limma","annotate",
                     "AnnotationDbi","GEOquery",
                    "org.Hs.eg.db","hgu133plus2.db"))
library(affy)
library(limma)
library(annotate)
library(AnnotationDbi)
library(GEOquery)
library(org.Hs.eg.db)
library(hgu133plus2.db)

#Graph variables, and aesthetics and functions for ggplot
plot.mean <- function(x) { 
  m <- mean(x,na.rm = TRUE) 
  c(y = m, ymin = m, ymax =m) }

plot.median <- function(x) { 
  m <- median(x, na.rm = TRUE) 
  c(y = m, ymin = m, ymax =m) }

Graph_Settings <- 
  theme(panel.background = element_rect(fill = "white"),axis.line = element_line(colour = "black"), 
        axis.text = element_text(size = 12, color = "black"), axis.title = element_text(size = 12, color = "black", face = "bold"))







volcanoplot <- 
ggplot(sig_goi_AAVvsHC_glom,aes(x = 2^logFC, y = -log10(adj.P.Val),label = Symbol, color = Group)) + 
geom_point() + 
geom_hline(aes(yintercept = log10(0.05)),linetype = "dashed") + 
geom_vline(xintercept = 1.5,color = "black",size = 0.5,linetype = "dashed") +

#Graph customization
Graph_Settings + 
geom_label_repel(nudge_x = 0.1,nudge_y = -0.1,size = 3) + 
scale_x_continuous(limits = c(-2,4),breaks = seq(-2,4,by = 1)) + 
xlab("Fold Change")



